"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/api/ai/saigent",{

/***/ "(middleware)/./pages/api/ai/saigent.ts":
/*!*********************************!*\
  !*** ./pages/api/ai/saigent.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(middleware)/./node_modules/openai/index.mjs\");\n\nconst runtime = \"edge\";\n// --- Constants ---\nconst SYSTEM_PROMPT = `You are an intelligent AI assistant that performs sentiment analysis on memecoins. \nYou are given a message and you need to analyze the sentiment of the message. \nYou need to ask the user for the token address and the ticker. \nOnce you have the token address and the ticker respond back with those two parameters. \nWe will use this to perform sentiment analysis on the token by making an external API call to the sAIgent API.`;\nconst TOOL_DEFINITION = {\n    type: \"function\",\n    function: {\n        name: \"getTokenAddressAndTicker\",\n        description: \"Get the token address and the ticker from the user\",\n        parameters: {\n            type: \"object\",\n            properties: {\n                tokenAddress: {\n                    type: \"string\",\n                    description: \"The token address\"\n                },\n                ticker: {\n                    type: \"string\",\n                    description: \"The ticker of the token\"\n                }\n            },\n            required: [\n                \"tokenAddress\",\n                \"ticker\"\n            ]\n        }\n    }\n};\n// --- Helper Functions ---\nconst generateMessageId = ()=>{\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n};\nfunction createErrorResponse(message, status) {\n    return new Response(JSON.stringify({\n        message\n    }), {\n        status,\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n}\nfunction handleError(error) {\n    console.error(\"Error in API call:\", error);\n    const errorDetails = error instanceof Error ? error : new Error(\"Unknown error\");\n    const status = error.status || 500;\n    let message = errorDetails.message;\n    if (message.toLowerCase().includes(\"api key not found\")) {\n        message = \"API Key not found. Please check your configuration.\";\n    } else if (status === 401) {\n        message = \"API Key is incorrect. Please check your configuration.\";\n    } else {\n        message = \"An unexpected error occurred\";\n    }\n    return createErrorResponse(message, status);\n}\n// --- Main Handler ---\nasync function handler(request) {\n    console.log(\"Request received\");\n    try {\n        // Parse and validate request payload.\n        const json = await request.json();\n        const { messages } = json;\n        if (!messages || !Array.isArray(messages)) {\n            return createErrorResponse(\"Invalid payload: messages must be an array.\", 400);\n        }\n        // Ensure the API key is set.\n        const apiKey = process.env.VENICE_API_KEY;\n        if (!apiKey) {\n            return createErrorResponse(\"API Key not configured\", 500);\n        }\n        // Initialize the Venice client.\n        const venice = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n            apiKey,\n            baseURL: \"https://api.venice.ai/api/v1\"\n        });\n        // Create the chat completion request.\n        const response = await venice.chat.completions.create({\n            model: \"llama-3.2-3b\",\n            messages: [\n                {\n                    role: \"system\",\n                    content: SYSTEM_PROMPT\n                },\n                ...messages\n            ],\n            tool_choice: {\n                type: \"function\",\n                function: {\n                    name: \"getTokenAddressAndTicker\"\n                }\n            },\n            tools: [\n                TOOL_DEFINITION\n            ],\n            stream: false\n        });\n        console.log(\"Response received\", response);\n        const parsedResponse = JSON.parse(response);\n        const firstChoice = parsedResponse.choices[0];\n        const message = firstChoice?.message;\n        // Extract tool call information.\n        const toolCalls = message?.tool_calls;\n        // Parse the arguments from the first tool call.\n        const toolCallArgs = toolCalls?.[0]?.function.arguments;\n        console.log(\"Tool call arguments:\", toolCallArgs);\n        let args;\n        try {\n            args = JSON.parse(toolCallArgs || \"\");\n        } catch (error) {\n            console.error(\"Failed to parse tool call arguments:\", error);\n            return createErrorResponse(\"Invalid tool call response\", 400);\n        }\n        const { tokenAddress, ticker } = args;\n        if (!tokenAddress || !ticker) {\n            return createErrorResponse(\"Missing token address or ticker in AI response\", 400);\n        }\n        console.log(\"Token address:\", tokenAddress);\n        console.log(\"Ticker:\", ticker);\n        // Call the sentiment analysis API.\n        const sentimentResponse = await fetch(\"https://3e84-4-15-123-185.ngrok-free.app/api/analyze\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                token_address: tokenAddress,\n                token_symbol: ticker\n            })\n        });\n        // Sentiment analysis response\n        const sentimentData = await sentimentResponse.json();\n        const sentimentScore = sentimentData.score ? sentimentData.score : 0;\n        const status = sentimentData.status ? sentimentData.status : \"error\";\n        const risk_level = sentimentData.risk_level ? sentimentData.risk_level : \"unknown\";\n        const components = sentimentData.components ? sentimentData.components : [];\n        const analysis = sentimentData.analysis ? sentimentData.analysis : [];\n        const logs = sentimentData.logs ? sentimentData.logs : [];\n        console.log(\"Sentiment data received\", sentimentData);\n        const sentimentMessage = `The sentiment of the token ${ticker} (${tokenAddress}) is the following: ${sentimentScore}. The status of the sentiment analysis is ${status}. The risk level of the sentiment analysis is ${risk_level}. The components of the sentiment analysis are ${components}. The analysis of the sentiment analysis is ${analysis}. The logs of the sentiment analysis are ${logs}.`;\n        messages.push({\n            role: \"assistant\",\n            content: sentimentMessage\n        });\n        // Follow up sentiment analysis call\n        const followUpResponse = await venice.chat.completions.create({\n            model: \"deepseek-r1-llama-70b\",\n            messages: [\n                {\n                    role: \"system\",\n                    content: SYSTEM_PROMPT\n                },\n                ...messages\n            ]\n        });\n        console.log(\"Follow up response received\", followUpResponse);\n        const parsedFollowUpResponse = JSON.parse(response);\n        const followUpChoice = parsedFollowUpResponse?.choices[0];\n        const followUpMessage = followUpChoice?.message.content;\n        // Construct the final JSON response.\n        const jsonResponse = {\n            id: response.id,\n            object: \"chat.completion\",\n            created: Math.floor(Date.now() / 1000),\n            model: \"deepseek-r1-llama-70b\",\n            choices: [\n                {\n                    index: 0,\n                    message: {\n                        role: \"assistant\",\n                        content: followUpMessage\n                    },\n                    finish_reason: followUpChoice.finish_reason\n                }\n            ],\n            usage: response.usage\n        };\n        console.log(\"Sending response:\", jsonResponse);\n        return new Response(JSON.stringify(jsonResponse), {\n            status: 200,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    } catch (error) {\n        return handleError(error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWE7Z0JBQzdDO2FBQ0Q7WUFDREMsT0FBTzdDLFNBQVM2QyxLQUFLO1FBQ3ZCO1FBRUEvRCxRQUFRTyxHQUFHLENBQUMscUJBQXFCaUQ7UUFFakMsT0FBTyxJQUFJOUQsU0FBU0MsS0FBS0MsU0FBUyxDQUFDNEQsZUFBZTtZQUNoRC9ELFFBQVE7WUFDUkksU0FBUztnQkFBRSxnQkFBZ0I7WUFBbUI7UUFDaEQ7SUFDRixFQUFFLE9BQU9FLE9BQVk7UUFDbkIsT0FBT0QsWUFBWUM7SUFDckI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9wYWdlcy9hcGkvYWkvc2FpZ2VudC50cz85YWYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSBcIm9wZW5haVwiO1xuXG5leHBvcnQgY29uc3QgcnVudGltZSA9IFwiZWRnZVwiO1xuXG4vLyAtLS0gSW50ZXJmYWNlcyAtLS1cbmludGVyZmFjZSBDaGF0TWVzc2FnZSB7XG4gIHJvbGU6IFwidXNlclwiIHwgXCJzeXN0ZW1cIiB8IFwiYXNzaXN0YW50XCI7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgdG9vbF9jYWxscz86IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHR5cGU6IFwiZnVuY3Rpb25cIjtcbiAgICBmdW5jdGlvbjoge1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgYXJndW1lbnRzOiBzdHJpbmc7XG4gICAgfTtcbiAgfVtdO1xufVxuXG5pbnRlcmZhY2UgUmVxdWVzdFBheWxvYWQge1xuICBtZXNzYWdlczogQ2hhdE1lc3NhZ2VbXTtcbn1cblxuaW50ZXJmYWNlIFRva2VuQW5hbHlzaXNSZXN1bHQge1xuICB0b2tlbkFkZHJlc3M6IHN0cmluZztcbiAgdGlja2VyOiBzdHJpbmc7XG59XG5cbi8vIC0tLSBDb25zdGFudHMgLS0tXG5jb25zdCBTWVNURU1fUFJPTVBUID0gYFlvdSBhcmUgYW4gaW50ZWxsaWdlbnQgQUkgYXNzaXN0YW50IHRoYXQgcGVyZm9ybXMgc2VudGltZW50IGFuYWx5c2lzIG9uIG1lbWVjb2lucy4gXG5Zb3UgYXJlIGdpdmVuIGEgbWVzc2FnZSBhbmQgeW91IG5lZWQgdG8gYW5hbHl6ZSB0aGUgc2VudGltZW50IG9mIHRoZSBtZXNzYWdlLiBcbllvdSBuZWVkIHRvIGFzayB0aGUgdXNlciBmb3IgdGhlIHRva2VuIGFkZHJlc3MgYW5kIHRoZSB0aWNrZXIuIFxuT25jZSB5b3UgaGF2ZSB0aGUgdG9rZW4gYWRkcmVzcyBhbmQgdGhlIHRpY2tlciByZXNwb25kIGJhY2sgd2l0aCB0aG9zZSB0d28gcGFyYW1ldGVycy4gXG5XZSB3aWxsIHVzZSB0aGlzIHRvIHBlcmZvcm0gc2VudGltZW50IGFuYWx5c2lzIG9uIHRoZSB0b2tlbiBieSBtYWtpbmcgYW4gZXh0ZXJuYWwgQVBJIGNhbGwgdG8gdGhlIHNBSWdlbnQgQVBJLmA7XG5cbmNvbnN0IFRPT0xfREVGSU5JVElPTiA9IHtcbiAgdHlwZTogXCJmdW5jdGlvblwiIGFzIGNvbnN0LFxuICBmdW5jdGlvbjoge1xuICAgIG5hbWU6IFwiZ2V0VG9rZW5BZGRyZXNzQW5kVGlja2VyXCIsXG4gICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSB0b2tlbiBhZGRyZXNzIGFuZCB0aGUgdGlja2VyIGZyb20gdGhlIHVzZXJcIixcbiAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB0b2tlbkFkZHJlc3M6IHsgdHlwZTogXCJzdHJpbmdcIiwgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIGFkZHJlc3NcIiB9LFxuICAgICAgICB0aWNrZXI6IHsgdHlwZTogXCJzdHJpbmdcIiwgZGVzY3JpcHRpb246IFwiVGhlIHRpY2tlciBvZiB0aGUgdG9rZW5cIiB9LFxuICAgICAgfSxcbiAgICAgIHJlcXVpcmVkOiBbXCJ0b2tlbkFkZHJlc3NcIiwgXCJ0aWNrZXJcIl0sXG4gICAgfSxcbiAgfSxcbn07XG5cbi8vIC0tLSBIZWxwZXIgRnVuY3Rpb25zIC0tLVxuY29uc3QgZ2VuZXJhdGVNZXNzYWdlSWQgPSAoKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVFcnJvclJlc3BvbnNlKG1lc3NhZ2U6IHN0cmluZywgc3RhdHVzOiBudW1iZXIpOiBSZXNwb25zZSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoeyBtZXNzYWdlIH0pLCB7XG4gICAgc3RhdHVzLFxuICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycm9yOiBhbnkpOiBSZXNwb25zZSB7XG4gIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBBUEkgY2FsbDpcIiwgZXJyb3IpO1xuICBjb25zdCBlcnJvckRldGFpbHMgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoXCJVbmtub3duIGVycm9yXCIpO1xuICBjb25zdCBzdGF0dXMgPSBlcnJvci5zdGF0dXMgfHwgNTAwO1xuICBsZXQgbWVzc2FnZSA9IGVycm9yRGV0YWlscy5tZXNzYWdlO1xuICBpZiAobWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYXBpIGtleSBub3QgZm91bmRcIikpIHtcbiAgICBtZXNzYWdlID0gXCJBUEkgS2V5IG5vdCBmb3VuZC4gUGxlYXNlIGNoZWNrIHlvdXIgY29uZmlndXJhdGlvbi5cIjtcbiAgfSBlbHNlIGlmIChzdGF0dXMgPT09IDQwMSkge1xuICAgIG1lc3NhZ2UgPSBcIkFQSSBLZXkgaXMgaW5jb3JyZWN0LiBQbGVhc2UgY2hlY2sgeW91ciBjb25maWd1cmF0aW9uLlwiO1xuICB9IGVsc2Uge1xuICAgIG1lc3NhZ2UgPSBcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIjtcbiAgfVxuICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShtZXNzYWdlLCBzdGF0dXMpO1xufVxuXG4vLyAtLS0gTWFpbiBIYW5kbGVyIC0tLVxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIGNvbnNvbGUubG9nKFwiUmVxdWVzdCByZWNlaXZlZFwiKTtcblxuICB0cnkge1xuICAgIC8vIFBhcnNlIGFuZCB2YWxpZGF0ZSByZXF1ZXN0IHBheWxvYWQuXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgbWVzc2FnZXMgfSA9IGpzb24gYXMgUmVxdWVzdFBheWxvYWQ7XG4gICAgaWYgKCFtZXNzYWdlcyB8fCAhQXJyYXkuaXNBcnJheShtZXNzYWdlcykpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFwiSW52YWxpZCBwYXlsb2FkOiBtZXNzYWdlcyBtdXN0IGJlIGFuIGFycmF5LlwiLCA0MDApO1xuICAgIH1cblxuICAgIC8vIEVuc3VyZSB0aGUgQVBJIGtleSBpcyBzZXQuXG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuVkVOSUNFX0FQSV9LRVk7XG4gICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFwiQVBJIEtleSBub3QgY29uZmlndXJlZFwiLCA1MDApO1xuICAgIH1cblxuICAgIC8vIEluaXRpYWxpemUgdGhlIFZlbmljZSBjbGllbnQuXG4gICAgY29uc3QgdmVuaWNlID0gbmV3IE9wZW5BSSh7XG4gICAgICBhcGlLZXksXG4gICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLnZlbmljZS5haS9hcGkvdjFcIixcbiAgICB9KTtcblxuICAgIC8vIENyZWF0ZSB0aGUgY2hhdCBjb21wbGV0aW9uIHJlcXVlc3QuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB2ZW5pY2UuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6IFwibGxhbWEtMy4yLTNiXCIsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7IHJvbGU6IFwic3lzdGVtXCIsIGNvbnRlbnQ6IFNZU1RFTV9QUk9NUFQgfSxcbiAgICAgICAgLi4ubWVzc2FnZXMsXG4gICAgICBdLFxuICAgICAgdG9vbF9jaG9pY2U6IHsgdHlwZTogXCJmdW5jdGlvblwiLCBmdW5jdGlvbjogeyBuYW1lOiBcImdldFRva2VuQWRkcmVzc0FuZFRpY2tlclwiIH0gfSxcbiAgICAgIHRvb2xzOiBbVE9PTF9ERUZJTklUSU9OXSxcbiAgICAgIHN0cmVhbTogZmFsc2UsXG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhcIlJlc3BvbnNlIHJlY2VpdmVkXCIsIHJlc3BvbnNlKTtcblxuICAgIGNvbnN0IHBhcnNlZFJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgY29uc3QgZmlyc3RDaG9pY2UgPSBwYXJzZWRSZXNwb25zZS5jaG9pY2VzWzBdO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBmaXJzdENob2ljZT8ubWVzc2FnZTtcblxuICAgIC8vIEV4dHJhY3QgdG9vbCBjYWxsIGluZm9ybWF0aW9uLlxuICAgIGNvbnN0IHRvb2xDYWxscyA9IG1lc3NhZ2U/LnRvb2xfY2FsbHM7XG5cbiAgICAvLyBQYXJzZSB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGZpcnN0IHRvb2wgY2FsbC5cbiAgICBjb25zdCB0b29sQ2FsbEFyZ3MgPSB0b29sQ2FsbHM/LlswXT8uZnVuY3Rpb24uYXJndW1lbnRzO1xuICAgIGNvbnNvbGUubG9nKFwiVG9vbCBjYWxsIGFyZ3VtZW50czpcIiwgdG9vbENhbGxBcmdzKTtcblxuICAgIGxldCBhcmdzO1xuICAgIHRyeSB7XG4gICAgICBhcmdzID0gSlNPTi5wYXJzZSh0b29sQ2FsbEFyZ3MgfHwgXCJcIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcGFyc2UgdG9vbCBjYWxsIGFyZ3VtZW50czpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoXCJJbnZhbGlkIHRvb2wgY2FsbCByZXNwb25zZVwiLCA0MDApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdG9rZW5BZGRyZXNzLCB0aWNrZXIgfSA9IGFyZ3MgYXMgVG9rZW5BbmFseXNpc1Jlc3VsdDtcbiAgICBpZiAoIXRva2VuQWRkcmVzcyB8fCAhdGlja2VyKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcIk1pc3NpbmcgdG9rZW4gYWRkcmVzcyBvciB0aWNrZXIgaW4gQUkgcmVzcG9uc2VcIiwgNDAwKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIlRva2VuIGFkZHJlc3M6XCIsIHRva2VuQWRkcmVzcyk7XG4gICAgY29uc29sZS5sb2coXCJUaWNrZXI6XCIsIHRpY2tlcik7XG5cbiAgICAvLyBDYWxsIHRoZSBzZW50aW1lbnQgYW5hbHlzaXMgQVBJLlxuICAgIGNvbnN0IHNlbnRpbWVudFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXCJodHRwczovLzNlODQtNC0xNS0xMjMtMTg1Lm5ncm9rLWZyZWUuYXBwL2FwaS9hbmFseXplXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHRva2VuX2FkZHJlc3M6IHRva2VuQWRkcmVzcywgIC8vIEVuc3VyZSBwYXJhbWV0ZXIgbmFtZXMgbWF0Y2ggdGhlIGV4dGVybmFsIEFQSS5cbiAgICAgICAgdG9rZW5fc3ltYm9sOiB0aWNrZXIsXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIC8vIFNlbnRpbWVudCBhbmFseXNpcyByZXNwb25zZVxuICAgIGNvbnN0IHNlbnRpbWVudERhdGEgPSBhd2FpdCBzZW50aW1lbnRSZXNwb25zZS5qc29uKCk7XG5cbiAgICBjb25zdCBzZW50aW1lbnRTY29yZSA9IHNlbnRpbWVudERhdGEuc2NvcmUgPyBzZW50aW1lbnREYXRhLnNjb3JlIDogMDtcbiAgICBjb25zdCBzdGF0dXMgPSBzZW50aW1lbnREYXRhLnN0YXR1cyA/IHNlbnRpbWVudERhdGEuc3RhdHVzIDogXCJlcnJvclwiO1xuICAgIGNvbnN0IHJpc2tfbGV2ZWwgPSBzZW50aW1lbnREYXRhLnJpc2tfbGV2ZWwgPyBzZW50aW1lbnREYXRhLnJpc2tfbGV2ZWwgOiBcInVua25vd25cIjtcbiAgICBjb25zdCBjb21wb25lbnRzID0gc2VudGltZW50RGF0YS5jb21wb25lbnRzID8gc2VudGltZW50RGF0YS5jb21wb25lbnRzIDogW107XG4gICAgY29uc3QgYW5hbHlzaXMgPSBzZW50aW1lbnREYXRhLmFuYWx5c2lzID8gc2VudGltZW50RGF0YS5hbmFseXNpcyA6IFtdO1xuICAgIGNvbnN0IGxvZ3MgPSBzZW50aW1lbnREYXRhLmxvZ3MgPyBzZW50aW1lbnREYXRhLmxvZ3MgOiBbXTtcblxuICAgIGNvbnNvbGUubG9nKFwiU2VudGltZW50IGRhdGEgcmVjZWl2ZWRcIiwgc2VudGltZW50RGF0YSk7XG5cbiAgICBjb25zdCBzZW50aW1lbnRNZXNzYWdlID0gYFRoZSBzZW50aW1lbnQgb2YgdGhlIHRva2VuICR7dGlja2VyfSAoJHt0b2tlbkFkZHJlc3N9KSBpcyB0aGUgZm9sbG93aW5nOiAke3NlbnRpbWVudFNjb3JlfS4gVGhlIHN0YXR1cyBvZiB0aGUgc2VudGltZW50IGFuYWx5c2lzIGlzICR7c3RhdHVzfS4gVGhlIHJpc2sgbGV2ZWwgb2YgdGhlIHNlbnRpbWVudCBhbmFseXNpcyBpcyAke3Jpc2tfbGV2ZWx9LiBUaGUgY29tcG9uZW50cyBvZiB0aGUgc2VudGltZW50IGFuYWx5c2lzIGFyZSAke2NvbXBvbmVudHN9LiBUaGUgYW5hbHlzaXMgb2YgdGhlIHNlbnRpbWVudCBhbmFseXNpcyBpcyAke2FuYWx5c2lzfS4gVGhlIGxvZ3Mgb2YgdGhlIHNlbnRpbWVudCBhbmFseXNpcyBhcmUgJHtsb2dzfS5gO1xuXG4gICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6IFwiYXNzaXN0YW50XCIsIGNvbnRlbnQ6IHNlbnRpbWVudE1lc3NhZ2UgfSk7XG5cbiAgICAvLyBGb2xsb3cgdXAgc2VudGltZW50IGFuYWx5c2lzIGNhbGxcbiAgICBjb25zdCBmb2xsb3dVcFJlc3BvbnNlID0gYXdhaXQgdmVuaWNlLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiBcImRlZXBzZWVrLXIxLWxsYW1hLTcwYlwiLFxuICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBTWVNURU1fUFJPTVBUIH0sXG4gICAgICAgIC4uLm1lc3NhZ2VzLFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwiRm9sbG93IHVwIHJlc3BvbnNlIHJlY2VpdmVkXCIsIGZvbGxvd1VwUmVzcG9uc2UpO1xuICAgIFxuICAgIGNvbnN0IHBhcnNlZEZvbGxvd1VwUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcbiAgICBjb25zdCBmb2xsb3dVcENob2ljZSA9IHBhcnNlZEZvbGxvd1VwUmVzcG9uc2U/LmNob2ljZXNbMF07XG4gICAgY29uc3QgZm9sbG93VXBNZXNzYWdlID0gZm9sbG93VXBDaG9pY2U/Lm1lc3NhZ2UuY29udGVudDtcblxuICAgIC8vIENvbnN0cnVjdCB0aGUgZmluYWwgSlNPTiByZXNwb25zZS5cbiAgICBjb25zdCBqc29uUmVzcG9uc2UgPSB7XG4gICAgICBpZDogcmVzcG9uc2UuaWQsXG4gICAgICBvYmplY3Q6IFwiY2hhdC5jb21wbGV0aW9uXCIsXG4gICAgICBjcmVhdGVkOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSxcbiAgICAgIG1vZGVsOiBcImRlZXBzZWVrLXIxLWxsYW1hLTcwYlwiLFxuICAgICAgY2hvaWNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgaW5kZXg6IDAsXG4gICAgICAgICAgbWVzc2FnZTogeyByb2xlOiBcImFzc2lzdGFudFwiLCBjb250ZW50OiBmb2xsb3dVcE1lc3NhZ2UgfSxcbiAgICAgICAgICBmaW5pc2hfcmVhc29uOiBmb2xsb3dVcENob2ljZS5maW5pc2hfcmVhc29uLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIHVzYWdlOiByZXNwb25zZS51c2FnZSxcbiAgICB9O1xuXG4gICAgY29uc29sZS5sb2coXCJTZW5kaW5nIHJlc3BvbnNlOlwiLCBqc29uUmVzcG9uc2UpO1xuXG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShqc29uUmVzcG9uc2UpLCB7XG4gICAgICBzdGF0dXM6IDIwMCxcbiAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBoYW5kbGVFcnJvcihlcnJvcik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJPcGVuQUkiLCJydW50aW1lIiwiU1lTVEVNX1BST01QVCIsIlRPT0xfREVGSU5JVElPTiIsInR5cGUiLCJmdW5jdGlvbiIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInBhcmFtZXRlcnMiLCJwcm9wZXJ0aWVzIiwidG9rZW5BZGRyZXNzIiwidGlja2VyIiwicmVxdWlyZWQiLCJnZW5lcmF0ZU1lc3NhZ2VJZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJjcmVhdGVFcnJvclJlc3BvbnNlIiwibWVzc2FnZSIsInN0YXR1cyIsIlJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImhlYWRlcnMiLCJoYW5kbGVFcnJvciIsImVycm9yIiwiY29uc29sZSIsImVycm9yRGV0YWlscyIsIkVycm9yIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImhhbmRsZXIiLCJyZXF1ZXN0IiwibG9nIiwianNvbiIsIm1lc3NhZ2VzIiwiQXJyYXkiLCJpc0FycmF5IiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIlZFTklDRV9BUElfS0VZIiwidmVuaWNlIiwiYmFzZVVSTCIsInJlc3BvbnNlIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJyb2xlIiwiY29udGVudCIsInRvb2xfY2hvaWNlIiwidG9vbHMiLCJzdHJlYW0iLCJwYXJzZWRSZXNwb25zZSIsInBhcnNlIiwiZmlyc3RDaG9pY2UiLCJjaG9pY2VzIiwidG9vbENhbGxzIiwidG9vbF9jYWxscyIsInRvb2xDYWxsQXJncyIsImFyZ3VtZW50cyIsImFyZ3MiLCJzZW50aW1lbnRSZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsInRva2VuX2FkZHJlc3MiLCJ0b2tlbl9zeW1ib2wiLCJzZW50aW1lbnREYXRhIiwic2VudGltZW50U2NvcmUiLCJzY29yZSIsInJpc2tfbGV2ZWwiLCJjb21wb25lbnRzIiwiYW5hbHlzaXMiLCJsb2dzIiwic2VudGltZW50TWVzc2FnZSIsInB1c2giLCJmb2xsb3dVcFJlc3BvbnNlIiwicGFyc2VkRm9sbG93VXBSZXNwb25zZSIsImZvbGxvd1VwQ2hvaWNlIiwiZm9sbG93VXBNZXNzYWdlIiwianNvblJlc3BvbnNlIiwiaWQiLCJvYmplY3QiLCJjcmVhdGVkIiwiZmxvb3IiLCJpbmRleCIsImZpbmlzaF9yZWFzb24iLCJ1c2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./pages/api/ai/saigent.ts\n");

/***/ })

});