"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/api/ai/saigent",{

/***/ "(middleware)/./pages/api/ai/saigent.ts":
/*!*********************************!*\
  !*** ./pages/api/ai/saigent.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\nconst runtime = \"edge\";\n// Constants\nconst SYSTEM_PROMPT = `You are an intelligent AI assistant that performs sentiment analysis on memecoins. \nYou are given a message and you need to analyze the sentiment of the message. \nYou need to ask the user for the token address and the ticker. \nOnce you have the token address and the ticker respond back with those two parameters. \nWe will use this to perform sentiment analysis on the token by making an external API call to the sAIgent API.`;\nconst FOLLOW_UP_SYSTEM_PROMPT = `You are an AI assistant analyzing cryptocurrency sentiment data.\nGiven the sentiment analysis results, provide a detailed and insightful interpretation of the findings.\nFocus on explaining the risk level, analysis components, and overall sentiment score in a way that helps users understand the token's current market perception.`;\nconst TOOL_DEFINITION = {\n    type: \"function\",\n    function: {\n        name: \"getTokenAddressAndTicker\",\n        description: \"Get the token address and the ticker from the user\",\n        parameters: {\n            type: \"object\",\n            properties: {\n                tokenAddress: {\n                    type: \"string\",\n                    description: \"The token address\"\n                },\n                ticker: {\n                    type: \"string\",\n                    description: \"The ticker of the token\"\n                }\n            },\n            required: [\n                \"tokenAddress\",\n                \"ticker\"\n            ]\n        }\n    }\n};\nasync function handler(request) {\n    try {\n        // Parse the incoming request JSON\n        const json = await request.json();\n        console.log(\"Received request:\", json);\n        const { messages } = json;\n        if (!messages || !Array.isArray(messages)) {\n            return new Response(JSON.stringify({\n                message: \"Invalid payload: messages must be an array.\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // Ensure the API key is set\n        const apiKey = process.env.VENICE_API_KEY;\n        if (!apiKey) {\n            return new Response(JSON.stringify({\n                message: \"API Key not configured\"\n            }), {\n                status: 500,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // First call: Get token information\n        const tokenInfoRequestOptions = {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${apiKey}`\n            },\n            body: JSON.stringify({\n                model: \"llama-3.2-3b\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: SYSTEM_PROMPT\n                    },\n                    ...messages\n                ],\n                tool_choice: {\n                    type: \"function\",\n                    function: {\n                        name: \"getTokenAddressAndTicker\"\n                    }\n                },\n                tools: [\n                    TOOL_DEFINITION\n                ],\n                stream: false\n            })\n        };\n        const tokenInfoResponse = await fetch(\"https://api.venice.ai/api/v1/chat/completions\", tokenInfoRequestOptions);\n        if (!tokenInfoResponse.ok) {\n            throw new Error(`HTTP error! status: ${tokenInfoResponse.status}`);\n        }\n        const tokenInfoData = await tokenInfoResponse.json();\n        console.log(\"Token info response received:\", tokenInfoData);\n        // Parse token information\n        const toolCalls = tokenInfoData.choices[0]?.message?.tool_calls;\n        const toolCallArgs = toolCalls?.[0]?.function.arguments;\n        let args;\n        try {\n            args = JSON.parse(toolCallArgs || \"\");\n        } catch (error) {\n            console.error(\"Failed to parse tool call arguments:\", error);\n            throw new Error(\"Invalid tool call response\");\n        }\n        const { tokenAddress, ticker } = args;\n        if (!tokenAddress || !ticker) {\n            throw new Error(\"Missing token address or ticker in AI response\");\n        }\n        // Call sentiment analysis API\n        const sentimentResponse = await fetch(\"https://64fd-4-15-123-185.ngrok-free.app/api/analyze\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                token_address: tokenAddress,\n                token_symbol: ticker\n            })\n        });\n        if (!sentimentResponse.ok) {\n            throw new Error(`Sentiment API error! status: ${sentimentResponse.status}`);\n        }\n        const sentimentData = await sentimentResponse.json();\n        console.log(\"Sentiment data received:\", sentimentData);\n        // Format sentiment data for follow-up analysis\n        const sentimentMessage = `Sentiment Analysis Results:\nScore: ${sentimentData.score || 0}\nStatus: ${sentimentData.status || \"unknown\"}\nRisk Level: ${sentimentData.risk_level || \"unknown\"}\nComponents: ${sentimentData.components}\nAnalysis: ${sentimentData.analysis}\nTechnical Details: ${sentimentData.logs}`;\n        // Follow-up call: Generate analysis of sentiment data\n        const followUpRequestOptions = {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${apiKey}`\n            },\n            body: JSON.stringify({\n                model: \"deepseek-r1-llama-70b\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: FOLLOW_UP_SYSTEM_PROMPT\n                    },\n                    ...messages,\n                    {\n                        role: \"assistant\",\n                        content: sentimentMessage\n                    }\n                ],\n                stream: false\n            })\n        };\n        const followUpResponse = await fetch(\"https://api.venice.ai/api/v1/chat/completions\", followUpRequestOptions);\n        if (!followUpResponse.ok) {\n            throw new Error(`HTTP error! status: ${followUpResponse.status}`);\n        }\n        const followUpData = await followUpResponse.json();\n        console.log(\"Follow-up analysis received:\", followUpData);\n        const finalChoice = followUpData.choices?.[0];\n        if (!finalChoice?.message) {\n            throw new Error(\"No message returned in the follow-up response.\");\n        }\n        // Construct the final JSON response\n        const jsonResponse = {\n            id: followUpData.id,\n            object: \"chat.completion\",\n            created: Math.floor(Date.now() / 1000),\n            model: \"deepseek-r1-llama-70b\",\n            choices: [\n                {\n                    index: 0,\n                    message: finalChoice.message,\n                    finish_reason: finalChoice.finish_reason\n                }\n            ],\n            usage: followUpData.usage\n        };\n        console.log(\"Sending response:\", jsonResponse);\n        return new Response(JSON.stringify(jsonResponse), {\n            status: 200,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    } catch (error) {\n        console.error(\"Error in API call:\", error);\n        let errorMessage = error.message || \"An unexpected error occurred\";\n        const errorCode = error.status || 500;\n        if (errorMessage.toLowerCase().includes(\"api key not found\")) {\n            errorMessage = \"API Key not found. Please check your configuration.\";\n        } else if (errorCode === 401) {\n            errorMessage = \"API Key is incorrect. Please check your configuration.\";\n        }\n        return new Response(JSON.stringify({\n            message: errorMessage\n        }), {\n            status: errorCode,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQzVCRCxlQUFlO1FBQ2pCO1FBRUEsT0FBTyxJQUFJekQsU0FBU0MsS0FBS0MsU0FBUyxDQUFDO1lBQUVDLFNBQVNzRDtRQUFhLElBQUk7WUFDN0RyRCxRQUFRc0Q7WUFDUnJELFNBQVM7Z0JBQUUsZ0JBQWdCO1lBQW1CO1FBQ2hEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9wYWdlcy9hcGkvYWkvc2FpZ2VudC50cz85YWYzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBydW50aW1lID0gXCJlZGdlXCI7XG5cbi8vIEludGVyZmFjZXNcbmludGVyZmFjZSBDaGF0TWVzc2FnZSB7XG4gIHJvbGU6IFwidXNlclwiIHwgXCJzeXN0ZW1cIiB8IFwiYXNzaXN0YW50XCI7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgdG9vbF9jYWxscz86IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHR5cGU6IFwiZnVuY3Rpb25cIjtcbiAgICBmdW5jdGlvbjoge1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgYXJndW1lbnRzOiBzdHJpbmc7XG4gICAgfTtcbiAgfVtdO1xufVxuXG4vLyBDb25zdGFudHNcbmNvbnN0IFNZU1RFTV9QUk9NUFQgPSBgWW91IGFyZSBhbiBpbnRlbGxpZ2VudCBBSSBhc3Npc3RhbnQgdGhhdCBwZXJmb3JtcyBzZW50aW1lbnQgYW5hbHlzaXMgb24gbWVtZWNvaW5zLiBcbllvdSBhcmUgZ2l2ZW4gYSBtZXNzYWdlIGFuZCB5b3UgbmVlZCB0byBhbmFseXplIHRoZSBzZW50aW1lbnQgb2YgdGhlIG1lc3NhZ2UuIFxuWW91IG5lZWQgdG8gYXNrIHRoZSB1c2VyIGZvciB0aGUgdG9rZW4gYWRkcmVzcyBhbmQgdGhlIHRpY2tlci4gXG5PbmNlIHlvdSBoYXZlIHRoZSB0b2tlbiBhZGRyZXNzIGFuZCB0aGUgdGlja2VyIHJlc3BvbmQgYmFjayB3aXRoIHRob3NlIHR3byBwYXJhbWV0ZXJzLiBcbldlIHdpbGwgdXNlIHRoaXMgdG8gcGVyZm9ybSBzZW50aW1lbnQgYW5hbHlzaXMgb24gdGhlIHRva2VuIGJ5IG1ha2luZyBhbiBleHRlcm5hbCBBUEkgY2FsbCB0byB0aGUgc0FJZ2VudCBBUEkuYDtcblxuY29uc3QgRk9MTE9XX1VQX1NZU1RFTV9QUk9NUFQgPSBgWW91IGFyZSBhbiBBSSBhc3Npc3RhbnQgYW5hbHl6aW5nIGNyeXB0b2N1cnJlbmN5IHNlbnRpbWVudCBkYXRhLlxuR2l2ZW4gdGhlIHNlbnRpbWVudCBhbmFseXNpcyByZXN1bHRzLCBwcm92aWRlIGEgZGV0YWlsZWQgYW5kIGluc2lnaHRmdWwgaW50ZXJwcmV0YXRpb24gb2YgdGhlIGZpbmRpbmdzLlxuRm9jdXMgb24gZXhwbGFpbmluZyB0aGUgcmlzayBsZXZlbCwgYW5hbHlzaXMgY29tcG9uZW50cywgYW5kIG92ZXJhbGwgc2VudGltZW50IHNjb3JlIGluIGEgd2F5IHRoYXQgaGVscHMgdXNlcnMgdW5kZXJzdGFuZCB0aGUgdG9rZW4ncyBjdXJyZW50IG1hcmtldCBwZXJjZXB0aW9uLmA7XG5cbmNvbnN0IFRPT0xfREVGSU5JVElPTiA9IHtcbiAgdHlwZTogXCJmdW5jdGlvblwiLFxuICBmdW5jdGlvbjoge1xuICAgIG5hbWU6IFwiZ2V0VG9rZW5BZGRyZXNzQW5kVGlja2VyXCIsXG4gICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSB0b2tlbiBhZGRyZXNzIGFuZCB0aGUgdGlja2VyIGZyb20gdGhlIHVzZXJcIixcbiAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB0b2tlbkFkZHJlc3M6IHsgdHlwZTogXCJzdHJpbmdcIiwgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIGFkZHJlc3NcIiB9LFxuICAgICAgICB0aWNrZXI6IHsgdHlwZTogXCJzdHJpbmdcIiwgZGVzY3JpcHRpb246IFwiVGhlIHRpY2tlciBvZiB0aGUgdG9rZW5cIiB9LFxuICAgICAgfSxcbiAgICAgIHJlcXVpcmVkOiBbXCJ0b2tlbkFkZHJlc3NcIiwgXCJ0aWNrZXJcIl0sXG4gICAgfSxcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIFBhcnNlIHRoZSBpbmNvbWluZyByZXF1ZXN0IEpTT05cbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2coXCJSZWNlaXZlZCByZXF1ZXN0OlwiLCBqc29uKTtcbiAgICBjb25zdCB7IG1lc3NhZ2VzIH0gPSBqc29uIGFzIHsgbWVzc2FnZXM6IENoYXRNZXNzYWdlW10gfTtcblxuICAgIGlmICghbWVzc2FnZXMgfHwgIUFycmF5LmlzQXJyYXkobWVzc2FnZXMpKSB7XG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7IG1lc3NhZ2U6IFwiSW52YWxpZCBwYXlsb2FkOiBtZXNzYWdlcyBtdXN0IGJlIGFuIGFycmF5LlwiIH0pLFxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEVuc3VyZSB0aGUgQVBJIGtleSBpcyBzZXRcbiAgICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5WRU5JQ0VfQVBJX0tFWTtcbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBtZXNzYWdlOiBcIkFQSSBLZXkgbm90IGNvbmZpZ3VyZWRcIiB9KSxcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBGaXJzdCBjYWxsOiBHZXQgdG9rZW4gaW5mb3JtYXRpb25cbiAgICBjb25zdCB0b2tlbkluZm9SZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6IFwibGxhbWEtMy4yLTNiXCIsXG4gICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBTWVNURU1fUFJPTVBUIH0sXG4gICAgICAgICAgLi4ubWVzc2FnZXMsXG4gICAgICAgIF0sXG4gICAgICAgIHRvb2xfY2hvaWNlOiB7IHR5cGU6IFwiZnVuY3Rpb25cIiwgZnVuY3Rpb246IHsgbmFtZTogXCJnZXRUb2tlbkFkZHJlc3NBbmRUaWNrZXJcIiB9IH0sXG4gICAgICAgIHRvb2xzOiBbVE9PTF9ERUZJTklUSU9OXSxcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcbiAgICAgIH0pLFxuICAgIH07XG5cbiAgICBjb25zdCB0b2tlbkluZm9SZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgXCJodHRwczovL2FwaS52ZW5pY2UuYWkvYXBpL3YxL2NoYXQvY29tcGxldGlvbnNcIixcbiAgICAgIHRva2VuSW5mb1JlcXVlc3RPcHRpb25zXG4gICAgKTtcblxuICAgIGlmICghdG9rZW5JbmZvUmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Rva2VuSW5mb1Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2tlbkluZm9EYXRhID0gYXdhaXQgdG9rZW5JbmZvUmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKFwiVG9rZW4gaW5mbyByZXNwb25zZSByZWNlaXZlZDpcIiwgdG9rZW5JbmZvRGF0YSk7XG5cbiAgICAvLyBQYXJzZSB0b2tlbiBpbmZvcm1hdGlvblxuICAgIGNvbnN0IHRvb2xDYWxscyA9IHRva2VuSW5mb0RhdGEuY2hvaWNlc1swXT8ubWVzc2FnZT8udG9vbF9jYWxscztcbiAgICBjb25zdCB0b29sQ2FsbEFyZ3MgPSB0b29sQ2FsbHM/LlswXT8uZnVuY3Rpb24uYXJndW1lbnRzO1xuXG4gICAgbGV0IGFyZ3M7XG4gICAgdHJ5IHtcbiAgICAgIGFyZ3MgPSBKU09OLnBhcnNlKHRvb2xDYWxsQXJncyB8fCBcIlwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBwYXJzZSB0b29sIGNhbGwgYXJndW1lbnRzOlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHRvb2wgY2FsbCByZXNwb25zZVwiKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHRva2VuQWRkcmVzcywgdGlja2VyIH0gPSBhcmdzO1xuICAgIGlmICghdG9rZW5BZGRyZXNzIHx8ICF0aWNrZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdG9rZW4gYWRkcmVzcyBvciB0aWNrZXIgaW4gQUkgcmVzcG9uc2VcIik7XG4gICAgfVxuXG4gICAgLy8gQ2FsbCBzZW50aW1lbnQgYW5hbHlzaXMgQVBJXG4gICAgY29uc3Qgc2VudGltZW50UmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcImh0dHBzOi8vNjRmZC00LTE1LTEyMy0xODUubmdyb2stZnJlZS5hcHAvYXBpL2FuYWx5emVcIiwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdG9rZW5fYWRkcmVzczogdG9rZW5BZGRyZXNzLFxuICAgICAgICB0b2tlbl9zeW1ib2w6IHRpY2tlcixcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZW50aW1lbnRSZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTZW50aW1lbnQgQVBJIGVycm9yISBzdGF0dXM6ICR7c2VudGltZW50UmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIH1cblxuICAgIGNvbnN0IHNlbnRpbWVudERhdGEgPSBhd2FpdCBzZW50aW1lbnRSZXNwb25zZS5qc29uKCk7XG4gICAgY29uc29sZS5sb2coXCJTZW50aW1lbnQgZGF0YSByZWNlaXZlZDpcIiwgc2VudGltZW50RGF0YSk7XG5cbiAgICAvLyBGb3JtYXQgc2VudGltZW50IGRhdGEgZm9yIGZvbGxvdy11cCBhbmFseXNpc1xuICAgIGNvbnN0IHNlbnRpbWVudE1lc3NhZ2UgPSBgU2VudGltZW50IEFuYWx5c2lzIFJlc3VsdHM6XG5TY29yZTogJHtzZW50aW1lbnREYXRhLnNjb3JlIHx8IDB9XG5TdGF0dXM6ICR7c2VudGltZW50RGF0YS5zdGF0dXMgfHwgXCJ1bmtub3duXCJ9XG5SaXNrIExldmVsOiAke3NlbnRpbWVudERhdGEucmlza19sZXZlbCB8fCBcInVua25vd25cIn1cbkNvbXBvbmVudHM6ICR7c2VudGltZW50RGF0YS5jb21wb25lbnRzfVxuQW5hbHlzaXM6ICR7c2VudGltZW50RGF0YS5hbmFseXNpc31cblRlY2huaWNhbCBEZXRhaWxzOiAke3NlbnRpbWVudERhdGEubG9nc31gO1xuXG4gICAgLy8gRm9sbG93LXVwIGNhbGw6IEdlbmVyYXRlIGFuYWx5c2lzIG9mIHNlbnRpbWVudCBkYXRhXG4gICAgY29uc3QgZm9sbG93VXBSZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6IFwiZGVlcHNlZWstcjEtbGxhbWEtNzBiXCIsXG4gICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBGT0xMT1dfVVBfU1lTVEVNX1BST01QVCB9LFxuICAgICAgICAgIC4uLm1lc3NhZ2VzLFxuICAgICAgICAgIHsgcm9sZTogXCJhc3Npc3RhbnRcIiwgY29udGVudDogc2VudGltZW50TWVzc2FnZSB9XG4gICAgICAgIF0sXG4gICAgICAgIHN0cmVhbTogZmFsc2UsXG4gICAgICB9KSxcbiAgICB9O1xuXG4gICAgY29uc3QgZm9sbG93VXBSZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgXCJodHRwczovL2FwaS52ZW5pY2UuYWkvYXBpL3YxL2NoYXQvY29tcGxldGlvbnNcIixcbiAgICAgIGZvbGxvd1VwUmVxdWVzdE9wdGlvbnNcbiAgICApO1xuXG4gICAgaWYgKCFmb2xsb3dVcFJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtmb2xsb3dVcFJlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xsb3dVcERhdGEgPSBhd2FpdCBmb2xsb3dVcFJlc3BvbnNlLmpzb24oKTtcbiAgICBjb25zb2xlLmxvZyhcIkZvbGxvdy11cCBhbmFseXNpcyByZWNlaXZlZDpcIiwgZm9sbG93VXBEYXRhKTtcblxuICAgIGNvbnN0IGZpbmFsQ2hvaWNlID0gZm9sbG93VXBEYXRhLmNob2ljZXM/LlswXTtcbiAgICBpZiAoIWZpbmFsQ2hvaWNlPy5tZXNzYWdlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBtZXNzYWdlIHJldHVybmVkIGluIHRoZSBmb2xsb3ctdXAgcmVzcG9uc2UuXCIpO1xuICAgIH1cblxuICAgIC8vIENvbnN0cnVjdCB0aGUgZmluYWwgSlNPTiByZXNwb25zZVxuICAgIGNvbnN0IGpzb25SZXNwb25zZSA9IHtcbiAgICAgIGlkOiBmb2xsb3dVcERhdGEuaWQsXG4gICAgICBvYmplY3Q6IFwiY2hhdC5jb21wbGV0aW9uXCIsXG4gICAgICBjcmVhdGVkOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSxcbiAgICAgIG1vZGVsOiBcImRlZXBzZWVrLXIxLWxsYW1hLTcwYlwiLFxuICAgICAgY2hvaWNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgaW5kZXg6IDAsXG4gICAgICAgICAgbWVzc2FnZTogZmluYWxDaG9pY2UubWVzc2FnZSxcbiAgICAgICAgICBmaW5pc2hfcmVhc29uOiBmaW5hbENob2ljZS5maW5pc2hfcmVhc29uLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIHVzYWdlOiBmb2xsb3dVcERhdGEudXNhZ2UsXG4gICAgfTtcblxuICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyByZXNwb25zZTpcIiwganNvblJlc3BvbnNlKTtcblxuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoanNvblJlc3BvbnNlKSwge1xuICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gQVBJIGNhbGw6XCIsIGVycm9yKTtcbiAgICBsZXQgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZSB8fCBcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIjtcbiAgICBjb25zdCBlcnJvckNvZGUgPSBlcnJvci5zdGF0dXMgfHwgNTAwO1xuXG4gICAgaWYgKGVycm9yTWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYXBpIGtleSBub3QgZm91bmRcIikpIHtcbiAgICAgIGVycm9yTWVzc2FnZSA9IFwiQVBJIEtleSBub3QgZm91bmQuIFBsZWFzZSBjaGVjayB5b3VyIGNvbmZpZ3VyYXRpb24uXCI7XG4gICAgfSBlbHNlIGlmIChlcnJvckNvZGUgPT09IDQwMSkge1xuICAgICAgZXJyb3JNZXNzYWdlID0gXCJBUEkgS2V5IGlzIGluY29ycmVjdC4gUGxlYXNlIGNoZWNrIHlvdXIgY29uZmlndXJhdGlvbi5cIjtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgbWVzc2FnZTogZXJyb3JNZXNzYWdlIH0pLCB7XG4gICAgICBzdGF0dXM6IGVycm9yQ29kZSxcbiAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJydW50aW1lIiwiU1lTVEVNX1BST01QVCIsIkZPTExPV19VUF9TWVNURU1fUFJPTVBUIiwiVE9PTF9ERUZJTklUSU9OIiwidHlwZSIsImZ1bmN0aW9uIiwibmFtZSIsImRlc2NyaXB0aW9uIiwicGFyYW1ldGVycyIsInByb3BlcnRpZXMiLCJ0b2tlbkFkZHJlc3MiLCJ0aWNrZXIiLCJyZXF1aXJlZCIsImhhbmRsZXIiLCJyZXF1ZXN0IiwianNvbiIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlcyIsIkFycmF5IiwiaXNBcnJheSIsIlJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJoZWFkZXJzIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIlZFTklDRV9BUElfS0VZIiwidG9rZW5JbmZvUmVxdWVzdE9wdGlvbnMiLCJtZXRob2QiLCJib2R5IiwibW9kZWwiLCJyb2xlIiwiY29udGVudCIsInRvb2xfY2hvaWNlIiwidG9vbHMiLCJzdHJlYW0iLCJ0b2tlbkluZm9SZXNwb25zZSIsImZldGNoIiwib2siLCJFcnJvciIsInRva2VuSW5mb0RhdGEiLCJ0b29sQ2FsbHMiLCJjaG9pY2VzIiwidG9vbF9jYWxscyIsInRvb2xDYWxsQXJncyIsImFyZ3VtZW50cyIsImFyZ3MiLCJwYXJzZSIsImVycm9yIiwic2VudGltZW50UmVzcG9uc2UiLCJ0b2tlbl9hZGRyZXNzIiwidG9rZW5fc3ltYm9sIiwic2VudGltZW50RGF0YSIsInNlbnRpbWVudE1lc3NhZ2UiLCJzY29yZSIsInJpc2tfbGV2ZWwiLCJjb21wb25lbnRzIiwiYW5hbHlzaXMiLCJsb2dzIiwiZm9sbG93VXBSZXF1ZXN0T3B0aW9ucyIsImZvbGxvd1VwUmVzcG9uc2UiLCJmb2xsb3dVcERhdGEiLCJmaW5hbENob2ljZSIsImpzb25SZXNwb25zZSIsImlkIiwib2JqZWN0IiwiY3JlYXRlZCIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJub3ciLCJpbmRleCIsImZpbmlzaF9yZWFzb24iLCJ1c2FnZSIsImVycm9yTWVzc2FnZSIsImVycm9yQ29kZSIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./pages/api/ai/saigent.ts\n");

/***/ })

});